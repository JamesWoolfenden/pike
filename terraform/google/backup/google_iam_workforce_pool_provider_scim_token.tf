resource "google_iam_workforce_pool" "pool" {
  workforce_pool_id = "example-pool"
  parent            = "organizations/123456789"
  location          = "global"
}

resource "google_iam_workforce_pool_provider" "provider" {
  location          = "global"
  workforce_pool_id = google_iam_workforce_pool.pool.workforce_pool_id
  provider_id       = "example-prvdr"
  attribute_mapping = {
    "google.subject" = "assertion.sub"
  }
  oidc {
    issuer_uri = "https://accounts.thirdparty.com"
    client_id  = "client-id"
    client_secret {
      value {
        plain_text = "client-secret"
      }
    }
    web_sso_config {
      response_type             = "CODE"
      assertion_claims_behavior = "MERGE_USER_INFO_OVER_ID_TOKEN_CLAIMS"
      additional_scopes         = ["groups", "roles"]
    }
  }
  display_name        = "Display name"
  description         = "A sample OIDC workforce pool provider."
  disabled            = false
  attribute_condition = "true"
}



resource "google_iam_workforce_pool_provider_scim_token" "example" {
  location          = "global"
  workforce_pool_id = google_iam_workforce_pool.pool.workforce_pool_id
  provider_id       = google_iam_workforce_pool_provider.provider.provider_id
  scim_tenant_id    = google_iam_workforce_pool_provider_scim_tenant.tenant.scim_tenant_id
  scim_token_id     = "example-scim-token"
  display_name      = "SCIM Token display Name"
  # security_token and state are output only, not settable
}
